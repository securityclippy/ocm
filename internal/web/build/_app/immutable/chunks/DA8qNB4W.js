import{W as E,X as c,Y as f,Z as h,v as i,_ as m,a0 as l,a1 as o,a2 as u,a3 as T,a4 as g}from"./gARCV1Ho.js";function v(e,t){let s=null,n=i;var d;if(i){s=T;for(var r=g(document.head);r!==null&&(r.nodeType!==m||r.data!==e);)r=l(r);if(r===null)o(!1);else{var y=l(r);r.remove(),u(y)}}i||(d=document.head.appendChild(E()));try{c(()=>t(d),f|h)}finally{n&&(o(!0),u(s))}}const p="/admin/api";async function a(e,t){const s=await fetch(`${p}${e}`,{...t,headers:{"Content-Type":"application/json",...t==null?void 0:t.headers}});if(!s.ok){const n=await s.json().catch(()=>({error:"Unknown error"}));throw new Error(n.error||`HTTP ${s.status}`)}return s.json()}const C={getDashboard:()=>a("/dashboard"),listCredentials:()=>a("/credentials"),getCredential:e=>a(`/credentials/${e}`),createCredential:e=>a("/credentials",{method:"POST",body:JSON.stringify(e)}),updateCredential:(e,t)=>a(`/credentials/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteCredential:e=>a(`/credentials/${e}`,{method:"DELETE"}),listPendingRequests:()=>a("/requests"),approveRequest:(e,t="30m")=>a(`/requests/${e}/approve`,{method:"POST",body:JSON.stringify({ttl:t})}),denyRequest:e=>a(`/requests/${e}/deny`,{method:"POST"}),revokeElevation:(e,t)=>a(`/revoke/${e}/${t}`,{method:"POST"}),listAuditEntries:e=>a(`/audit${e?`?service=${e}`:""}`)};export{C as a,v as h};
