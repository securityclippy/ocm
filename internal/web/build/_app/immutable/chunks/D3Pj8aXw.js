function a(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}const r="/admin/api";async function t(e,s){const n=await fetch(`${r}${e}`,{...s,headers:{"Content-Type":"application/json",...s==null?void 0:s.headers}});if(!n.ok){const d=await n.json().catch(()=>({error:"Unknown error"}));throw new Error(d.error||`HTTP ${n.status}`)}return n.json()}const u={getSetupStatus:()=>t("/setup/status"),completeSetup:()=>t("/setup/complete",{method:"POST"}),getDashboard:()=>t("/dashboard"),listCredentials:()=>t("/credentials"),getCredential:e=>t(`/credentials/${e}`),createCredential:e=>t("/credentials",{method:"POST",body:JSON.stringify(e)}),updateCredential:(e,s)=>t(`/credentials/${e}`,{method:"PUT",body:JSON.stringify(s)}),deleteCredential:e=>t(`/credentials/${e}`,{method:"DELETE"}),listPendingRequests:()=>t("/requests"),approveRequest:(e,s="30m")=>t(`/requests/${e}/approve`,{method:"POST",body:JSON.stringify({ttl:s})}),denyRequest:e=>t(`/requests/${e}/deny`,{method:"POST"}),revokeElevation:(e,s)=>t(`/revoke/${e}/${s}`,{method:"POST"}),listAuditEntries:e=>t(`/audit${e?`?service=${e}`:""}`)};export{u as a,a as e};
