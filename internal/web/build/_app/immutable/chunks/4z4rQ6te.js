import{s as Te,n as re,d as _,v as qe,i as oe,b as a,o as g,c as b,e as y,q as Ie,g as w,h as E,j as M,D as Pe,r as Ve,a as C,z as ve,m as ne,A as Ne,f as R,t as S,x as we,l as Me}from"./CRWUcP0W.js";import{e as X,a as pe}from"./BN7ekvrY.js";import{S as Re,i as Se}from"./BcwE73Mx.js";function ge(e,t,l){const r=e.slice();return r[11]=t[l],r}function me(e,t,l){const r=e.slice();return r[14]=t[l],r}function be(e){let t,l=e[14].label+"",r;return{c(){t=E("option"),r=S(l),this.h()},l(u){t=b(u,"OPTION",{});var i=y(t);r=R(i,l),i.forEach(_),this.h()},h(){t.__value=e[14].value,Me(t,t.__value)},m(u,i){oe(u,t,i),a(t,r)},p:re,d(u){u&&_(t)}}}function Ee(e){let t,l,r,u,i,m=e[11].service+"",n,o,d,s=e[11].scope+"",D,j,N,f=(e[11].reason||"No reason provided")+"",k,Y,T,Z,B=De(e[11].requestedAt)+"",U,z,$,A,q,x,I,F=e[1]===e[11].id?"Approving...":"Approve",G,J,ee,P,H=e[2]===e[11].id?"Denying...":"Deny",K,Q,te,le,ie,O=X(e[4]),v=[];for(let p=0;p<O.length;p+=1)v[p]=be(me(e,O,p));function ke(){return e[8](e[11])}function Ae(){return e[9](e[11])}return{c(){t=E("div"),l=E("div"),r=E("div"),u=E("div"),i=E("span"),n=S(m),o=M(),d=E("span"),D=S(s),j=M(),N=E("p"),k=S(f),Y=M(),T=E("p"),Z=S("Requested "),U=S(B),$=M(),A=E("div"),q=E("select");for(let p=0;p<v.length;p+=1)v[p].c();x=M(),I=E("button"),G=S(F),ee=M(),P=E("button"),K=S(H),te=M(),this.h()},l(p){t=b(p,"DIV",{class:!0});var h=y(t);l=b(h,"DIV",{class:!0});var c=y(l);r=b(c,"DIV",{class:!0});var V=y(r);u=b(V,"DIV",{class:!0});var W=y(u);i=b(W,"SPAN",{class:!0});var ce=y(i);n=R(ce,m),ce.forEach(_),o=w(W),d=b(W,"SPAN",{class:!0});var ue=y(d);D=R(ue,s),ue.forEach(_),W.forEach(_),j=w(V),N=b(V,"P",{class:!0});var de=y(N);k=R(de,f),de.forEach(_),Y=w(V),T=b(V,"P",{class:!0,title:!0});var se=y(T);Z=R(se,"Requested "),U=R(se,B),se.forEach(_),V.forEach(_),$=w(c),A=b(c,"DIV",{class:!0});var L=y(A);q=b(L,"SELECT",{class:!0});var fe=y(q);for(let ae=0;ae<v.length;ae+=1)v[ae].l(fe);fe.forEach(_),x=w(L),I=b(L,"BUTTON",{class:!0});var he=y(I);G=R(he,F),he.forEach(_),ee=w(L),P=b(L,"BUTTON",{class:!0});var _e=y(P);K=R(_e,H),_e.forEach(_),L.forEach(_),c.forEach(_),te=w(h),h.forEach(_),this.h()},h(){g(i,"class","text-lg font-medium text-gray-900"),g(d,"class","px-2 py-0.5 text-xs font-medium bg-orange-100 text-orange-700 rounded"),g(u,"class","flex items-center gap-2"),g(N,"class","mt-1 text-sm text-gray-600"),g(T,"class","mt-1 text-xs text-gray-400"),g(T,"title",z=ye(e[11].requestedAt)),g(r,"class","flex-1"),g(q,"class","text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"),e[3]===void 0&&Ne(()=>e[7].call(q)),g(I,"class","btn btn-success"),I.disabled=J=e[1]===e[11].id,g(P,"class","btn btn-danger"),P.disabled=Q=e[2]===e[11].id,g(A,"class","flex items-center gap-2"),g(l,"class","flex items-start justify-between"),g(t,"class","p-6")},m(p,h){oe(p,t,h),a(t,l),a(l,r),a(r,u),a(u,i),a(i,n),a(u,o),a(u,d),a(d,D),a(r,j),a(r,N),a(N,k),a(r,Y),a(r,T),a(T,Z),a(T,U),a(l,$),a(l,A),a(A,q);for(let c=0;c<v.length;c+=1)v[c]&&v[c].m(q,null);ve(q,e[3],!0),a(A,x),a(A,I),a(I,G),a(A,ee),a(A,P),a(P,K),a(t,te),le||(ie=[ne(q,"change",e[7]),ne(I,"click",ke),ne(P,"click",Ae)],le=!0)},p(p,h){if(e=p,h&1&&m!==(m=e[11].service+"")&&C(n,m),h&1&&s!==(s=e[11].scope+"")&&C(D,s),h&1&&f!==(f=(e[11].reason||"No reason provided")+"")&&C(k,f),h&1&&B!==(B=De(e[11].requestedAt)+"")&&C(U,B),h&1&&z!==(z=ye(e[11].requestedAt))&&g(T,"title",z),h&16){O=X(e[4]);let c;for(c=0;c<O.length;c+=1){const V=me(e,O,c);v[c]?v[c].p(V,h):(v[c]=be(V),v[c].c(),v[c].m(q,null))}for(;c<v.length;c+=1)v[c].d(1);v.length=O.length}h&24&&ve(q,e[3]),h&3&&F!==(F=e[1]===e[11].id?"Approving...":"Approve")&&C(G,F),h&3&&J!==(J=e[1]===e[11].id)&&(I.disabled=J),h&5&&H!==(H=e[2]===e[11].id?"Denying...":"Deny")&&C(K,H),h&5&&Q!==(Q=e[2]===e[11].id)&&(P.disabled=Q)},d(p){p&&_(t),qe(v,p),le=!1,Ve(ie)}}}function Oe(e){let t,l,r='<h2 class="text-lg font-semibold text-gray-900">Pending Requests</h2>',u,i,m=X(e[0]),n=[];for(let o=0;o<m.length;o+=1)n[o]=Ee(ge(e,m,o));return{c(){t=E("div"),l=E("div"),l.innerHTML=r,u=M(),i=E("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){t=b(o,"DIV",{class:!0});var d=y(t);l=b(d,"DIV",{class:!0,"data-svelte-h":!0}),Ie(l)!=="svelte-15bo6r3"&&(l.innerHTML=r),u=w(d),i=b(d,"DIV",{class:!0});var s=y(i);for(let D=0;D<n.length;D+=1)n[D].l(s);s.forEach(_),d.forEach(_),this.h()},h(){g(l,"class","px-6 py-4 border-b border-gray-200"),g(i,"class","divide-y divide-gray-200"),g(t,"class","card")},m(o,d){oe(o,t,d),a(t,l),a(t,u),a(t,i);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,null)},p(o,[d]){if(d&127){m=X(o[0]);let s;for(s=0;s<m.length;s+=1){const D=ge(o,m,s);n[s]?n[s].p(D,d):(n[s]=Ee(D),n[s].c(),n[s].m(i,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=m.length}},i:re,o:re,d(o){o&&_(t),qe(n,o)}}}function ye(e){return new Date(e).toLocaleString()}function De(e){const t=Math.floor((Date.now()-new Date(e).getTime())/1e3);return t<60?`${t}s ago`:t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}function Le(e,t,l){let{requests:r}=t;const u=Pe();let i=null,m=null,n="30m";const o=[{value:"15m",label:"15 minutes"},{value:"30m",label:"30 minutes"},{value:"1h",label:"1 hour"},{value:"2h",label:"2 hours"},{value:"4h",label:"4 hours"}];async function d(f){l(1,i=f);try{await pe.approveRequest(f,n),u("action")}catch(k){alert(k instanceof Error?k.message:"Failed to approve")}finally{l(1,i=null)}}async function s(f){l(2,m=f);try{await pe.denyRequest(f),u("action")}catch(k){alert(k instanceof Error?k.message:"Failed to deny")}finally{l(2,m=null)}}function D(){n=we(this),l(3,n),l(4,o)}const j=f=>d(f.id),N=f=>s(f.id);return e.$$set=f=>{"requests"in f&&l(0,r=f.requests)},[r,i,m,n,o,d,s,D,j,N]}class Fe extends Re{constructor(t){super(),Se(this,t,Le,Oe,Te,{requests:0})}}export{Fe as P};
