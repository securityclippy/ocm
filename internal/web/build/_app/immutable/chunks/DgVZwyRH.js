import{T as E,U as c,V as f,W as T,I as i,X as h,Y as l,Z as o,_ as u,a0 as m,a1 as g}from"./vzSSS4xY.js";function v(e,t){let s=null,n=i;var d;if(i){s=m;for(var a=g(document.head);a!==null&&(a.nodeType!==h||a.data!==e);)a=l(a);if(a===null)o(!1);else{var y=l(a);a.remove(),u(y)}}i||(d=document.head.appendChild(E()));try{c(()=>t(d),f|T)}finally{n&&(o(!0),u(s))}}const p="/admin/api";async function r(e,t){const s=await fetch(`${p}${e}`,{...t,headers:{"Content-Type":"application/json",...t==null?void 0:t.headers}});if(!s.ok){const n=await s.json().catch(()=>({error:"Unknown error"}));throw new Error(n.error||`HTTP ${s.status}`)}return s.json()}const C={getDashboard:()=>r("/dashboard"),listCredentials:()=>r("/credentials"),getCredential:e=>r(`/credentials/${e}`),createCredential:e=>r("/credentials",{method:"POST",body:JSON.stringify(e)}),updateCredential:(e,t)=>r(`/credentials/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteCredential:e=>r(`/credentials/${e}`,{method:"DELETE"}),listPendingRequests:()=>r("/requests"),approveRequest:(e,t="30m")=>r(`/requests/${e}/approve`,{method:"POST",body:JSON.stringify({ttl:t})}),denyRequest:e=>r(`/requests/${e}/deny`,{method:"POST"}),revokeElevation:(e,t)=>r(`/revoke/${e}/${t}`,{method:"POST"}),listAuditEntries:e=>r(`/audit${e?`?service=${e}`:""}`)};export{C as a,v as h};
