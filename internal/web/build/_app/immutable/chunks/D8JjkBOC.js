import{s as p,a as P,e as Q,f as L}from"./BALovzVN.js";import{i as re}from"./DVv75SxZ.js";import{F as ie,J as T,e as ne,K as se,M as le,N as oe,O as ve,A as de,p as ue,Q as ce,s as m,c as s,r,t as W,g as e,n as o,a as fe,m as $,b as x}from"./vzSSS4xY.js";import{e as z,i as B,s as pe}from"./CW9yTeWy.js";import{p as me}from"./BKbhBXlj.js";import{a as C}from"./DgVZwyRH.js";function G(t,i,_=!1){if(t.multiple){if(i==null)return;if(!le(i))return oe();for(var v of t.options)v.selected=i.includes(h(v));return}for(v of t.options){var l=h(v);if(ve(l,i)){v.selected=!0;return}}(!_||i!==void 0)&&(t.selectedIndex=-1)}function _e(t){var i=new MutationObserver(()=>{G(t,t.__value)});i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),de(()=>{i.disconnect()})}function be(t,i,_=i){var v=new WeakSet,l=!0;ie(t,"change",n=>{var u=n?"[selected]":":checked",c;if(t.multiple)c=[].map.call(t.querySelectorAll(u),h);else{var w=t.querySelector(u)??t.querySelector("option:not([disabled])");c=w&&h(w)}_(c),T!==null&&v.add(T)}),ne(()=>{var n=i();if(t===document.activeElement){var u=se??T;if(v.has(u))return}if(G(t,n,l),l&&n===void 0){var c=t.querySelector(":checked");c!==null&&(n=h(c),_(n))}t.__value=n,l=!1}),_e(t)}function h(t){return"__value"in t?t.__value:t.value}var ge=L("<option> </option>"),ye=L('<div class="p-6"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-2"><span class="text-lg font-medium text-gray-900"> </span> <span class="px-2 py-0.5 text-xs font-medium bg-orange-100 text-orange-700 rounded"> </span></div> <p class="mt-1 text-sm text-gray-600"> </p> <p class="mt-1 text-xs text-gray-400"> </p></div> <div class="flex items-center gap-2"><select class="text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"></select> <button class="btn btn-success"> </button> <button class="btn btn-danger"> </button></div></div></div>'),xe=L('<div class="card"><div class="px-6 py-4 border-b border-gray-200"><h2 class="text-lg font-semibold text-gray-900">Pending Requests</h2></div> <div class="divide-y divide-gray-200"></div></div>');function Se(t,i){ue(i,!1);let _=me(i,"requests",8);const v=ce();let l=$(null),n=$(null),u=$("30m");const c=[{value:"15m",label:"15 minutes"},{value:"30m",label:"30 minutes"},{value:"1h",label:"1 hour"},{value:"2h",label:"2 hours"},{value:"4h",label:"4 hours"}];async function w(d){x(l,d);try{await C.approveRequest(d,e(u)),v("action")}catch(a){alert(a instanceof Error?a.message:"Failed to approve")}finally{x(l,null)}}async function H(d){x(n,d);try{await C.denyRequest(d),v("action")}catch(a){alert(a instanceof Error?a.message:"Failed to deny")}finally{x(n,null)}}function U(d){return new Date(d).toLocaleString()}function V(d){const a=Math.floor((Date.now()-new Date(d).getTime())/1e3);return a<60?`${a}s ago`:a<3600?`${Math.floor(a/60)}m ago`:a<86400?`${Math.floor(a/3600)}h ago`:`${Math.floor(a/86400)}d ago`}re();var D=xe(),N=m(s(D),2);z(N,5,_,B,(d,a)=>{var M=ye(),j=s(M),S=s(j),R=s(S),E=s(R),X=s(E,!0);r(E);var I=m(E,2),Y=s(I,!0);r(I),r(R);var F=m(R,2),Z=s(F,!0);r(F);var O=m(F,2),q=s(O);r(O),r(S);var J=m(S,2),A=s(J);z(A,5,()=>c,B,(g,f)=>{var y=ge(),te=s(y,!0);r(y);var K={};W(()=>{p(te,(e(f),o(()=>e(f).label))),K!==(K=(e(f),o(()=>e(f).value)))&&(y.value=(y.__value=(e(f),o(()=>e(f).value)))??"")}),P(g,y)}),r(A);var b=m(A,2),ee=s(b,!0);r(b);var k=m(b,2),ae=s(k,!0);r(k),r(J),r(j),r(M),W((g,f)=>{p(X,(e(a),o(()=>e(a).service))),p(Y,(e(a),o(()=>e(a).scope))),p(Z,(e(a),o(()=>e(a).reason||"No reason provided"))),pe(O,"title",g),p(q,`Requested ${f??""}`),b.disabled=(e(l),e(a),o(()=>e(l)===e(a).id)),p(ee,(e(l),e(a),o(()=>e(l)===e(a).id?"Approving...":"Approve"))),k.disabled=(e(n),e(a),o(()=>e(n)===e(a).id)),p(ae,(e(n),e(a),o(()=>e(n)===e(a).id?"Denying...":"Deny")))},[()=>(e(a),o(()=>U(e(a).requestedAt))),()=>(e(a),o(()=>V(e(a).requestedAt)))]),be(A,()=>e(u),g=>x(u,g)),Q("click",b,()=>w(e(a).id)),Q("click",k,()=>H(e(a).id)),P(d,M)}),r(N),r(D),P(t,D),fe()}export{Se as P};
