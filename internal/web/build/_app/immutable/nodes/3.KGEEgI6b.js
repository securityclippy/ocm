import{s as le,n as B,d,r as ae,l as K,i as E,b as o,m as O,o as p,p as re,g as D,c as m,e as y,q,j as A,h as v,u as ne,a as j,f as N,t as P,v as ie,w as Q}from"../chunks/CRWUcP0W.js";import{a as ce,e as W}from"../chunks/D3Pj8aXw.js";import{S as oe,i as de}from"../chunks/BcwE73Mx.js";function X(r,e,s){const t=r.slice();return t[7]=e[s],t}function ue(r){let e,s,t,i='<tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Service / Scope</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actor</th></tr>',c,l,n=W(r[0]),a=[];for(let f=0;f<n.length;f+=1)a[f]=$(X(r,n,f));return{c(){e=v("div"),s=v("table"),t=v("thead"),t.innerHTML=i,c=A(),l=v("tbody");for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){e=m(f,"DIV",{class:!0});var h=y(e);s=m(h,"TABLE",{class:!0});var u=y(s);t=m(u,"THEAD",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-470mjo"&&(t.innerHTML=i),c=D(u),l=m(u,"TBODY",{class:!0});var g=y(l);for(let T=0;T<a.length;T+=1)a[T].l(g);g.forEach(d),u.forEach(d),h.forEach(d),this.h()},h(){p(t,"class","bg-gray-50"),p(l,"class","bg-white divide-y divide-gray-200"),p(s,"class","min-w-full divide-y divide-gray-200"),p(e,"class","card overflow-hidden")},m(f,h){E(f,e,h),o(e,s),o(s,t),o(s,c),o(s,l);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(l,null)},p(f,h){if(h&1){n=W(f[0]);let u;for(u=0;u<n.length;u+=1){const g=X(f,n,u);a[u]?a[u].p(g,h):(a[u]=$(g),a[u].c(),a[u].m(l,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=n.length}},d(f){f&&d(e),ie(a,f)}}}function fe(r){let e,s='<div class="text-4xl mb-4">ðŸ“œ</div> <h3 class="text-lg font-medium text-gray-900">No audit entries</h3> <p class="mt-2 text-sm text-gray-500">Activity will appear here as it happens.</p>';return{c(){e=v("div"),e.innerHTML=s,this.h()},l(t){e=m(t,"DIV",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-1ytznce"&&(e.innerHTML=s),this.h()},h(){p(e,"class","card p-12 text-center")},m(t,i){E(t,e,i)},p:B,d(t){t&&d(e)}}}function pe(r){let e,s,t;return{c(){e=v("div"),s=v("p"),t=P(r[2]),this.h()},l(i){e=m(i,"DIV",{class:!0});var c=y(e);s=m(c,"P",{class:!0});var l=y(s);t=N(l,r[2]),l.forEach(d),c.forEach(d),this.h()},h(){p(s,"class","text-red-700"),p(e,"class","card p-4 bg-red-50 border-red-200")},m(i,c){E(i,e,c),o(e,s),o(s,t)},p(i,c){c&4&&j(t,i[2])},d(i){i&&d(e)}}}function he(r){let e,s='<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div>';return{c(){e=v("div"),e.innerHTML=s,this.h()},l(t){e=m(t,"DIV",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-18msshe"&&(e.innerHTML=s),this.h()},h(){p(e,"class","flex items-center justify-center py-12")},m(t,i){E(t,e,i)},p:B,d(t){t&&d(e)}}}function _e(r){let e,s="â€”";return{c(){e=v("span"),e.textContent=s,this.h()},l(t){e=m(t,"SPAN",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-phbfb1"&&(e.textContent=s),this.h()},h(){p(e,"class","text-gray-400")},m(t,i){E(t,e,i)},p:B,d(t){t&&d(e)}}}function me(r){let e,s=r[7].service+"",t,i,c,l=r[7].scope&&Z(r);return{c(){e=v("span"),t=P(s),i=A(),l&&l.c(),c=Q(),this.h()},l(n){e=m(n,"SPAN",{class:!0});var a=y(e);t=N(a,s),a.forEach(d),i=D(n),l&&l.l(n),c=Q(),this.h()},h(){p(e,"class","font-medium text-gray-900")},m(n,a){E(n,e,a),o(e,t),E(n,i,a),l&&l.m(n,a),E(n,c,a)},p(n,a){a&1&&s!==(s=n[7].service+"")&&j(t,s),n[7].scope?l?l.p(n,a):(l=Z(n),l.c(),l.m(c.parentNode,c)):l&&(l.d(1),l=null)},d(n){n&&(d(e),d(i),d(c)),l&&l.d(n)}}}function Z(r){let e,s,t=r[7].scope+"",i;return{c(){e=v("span"),s=P(":"),i=P(t),this.h()},l(c){e=m(c,"SPAN",{class:!0});var l=y(e);s=N(l,":"),i=N(l,t),l.forEach(d),this.h()},h(){p(e,"class","text-gray-500")},m(c,l){E(c,e,l),o(e,s),o(e,i)},p(c,l){l&1&&t!==(t=c[7].scope+"")&&j(i,t)},d(c){c&&d(e)}}}function $(r){let e,s,t=ee(r[7].timestamp)+"",i,c,l,n,a=se(r[7].action)+"",f,h,u,g,T,L,I=(r[7].details||"â€”")+"",S,k,_,w=r[7].actor+"",H,M;function V(b,x){return b[7].service?me:_e}let F=V(r),C=F(r);return{c(){e=v("tr"),s=v("td"),i=P(t),c=A(),l=v("td"),n=v("span"),f=P(a),u=A(),g=v("td"),C.c(),T=A(),L=v("td"),S=P(I),k=A(),_=v("td"),H=P(w),M=A(),this.h()},l(b){e=m(b,"TR",{class:!0});var x=y(e);s=m(x,"TD",{class:!0});var U=y(s);i=N(U,t),U.forEach(d),c=D(x),l=m(x,"TD",{class:!0});var R=y(l);n=m(R,"SPAN",{class:!0});var z=y(n);f=N(z,a),z.forEach(d),R.forEach(d),u=D(x),g=m(x,"TD",{class:!0});var Y=y(g);C.l(Y),Y.forEach(d),T=D(x),L=m(x,"TD",{class:!0});var G=y(L);S=N(G,I),G.forEach(d),k=D(x),_=m(x,"TD",{class:!0});var J=y(_);H=N(J,w),J.forEach(d),M=D(x),x.forEach(d),this.h()},h(){p(s,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),p(n,"class",h="px-2 py-1 text-xs font-medium rounded "+te(r[7].action)),p(l,"class","px-6 py-4 whitespace-nowrap"),p(g,"class","px-6 py-4 whitespace-nowrap text-sm"),p(L,"class","px-6 py-4 text-sm text-gray-500 max-w-xs truncate"),p(_,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),p(e,"class","hover:bg-gray-50")},m(b,x){E(b,e,x),o(e,s),o(s,i),o(e,c),o(e,l),o(l,n),o(n,f),o(e,u),o(e,g),C.m(g,null),o(e,T),o(e,L),o(L,S),o(e,k),o(e,_),o(_,H),o(e,M)},p(b,x){x&1&&t!==(t=ee(b[7].timestamp)+"")&&j(i,t),x&1&&a!==(a=se(b[7].action)+"")&&j(f,a),x&1&&h!==(h="px-2 py-1 text-xs font-medium rounded "+te(b[7].action))&&p(n,"class",h),F===(F=V(b))&&C?C.p(b,x):(C.d(1),C=F(b),C&&(C.c(),C.m(g,null))),x&1&&I!==(I=(b[7].details||"â€”")+"")&&j(S,I),x&1&&w!==(w=b[7].actor+"")&&j(H,w)},d(b){b&&d(e),C.d()}}}function ve(r){let e,s,t,i,c="Audit Log",l,n,a,f,h,u="Refresh",g,T,L;function I(_,w){return _[1]?he:_[2]?pe:_[0].length===0?fe:ue}let S=I(r),k=S(r);return{c(){e=A(),s=v("div"),t=v("div"),i=v("h1"),i.textContent=c,l=A(),n=v("div"),a=v("input"),f=A(),h=v("button"),h.textContent=u,g=A(),k.c(),this.h()},l(_){re("svelte-mxjb1d",document.head).forEach(d),e=D(_),s=m(_,"DIV",{class:!0});var H=y(s);t=m(H,"DIV",{class:!0});var M=y(t);i=m(M,"H1",{class:!0,"data-svelte-h":!0}),q(i)!=="svelte-eg0mfy"&&(i.textContent=c),l=D(M),n=m(M,"DIV",{class:!0});var V=y(n);a=m(V,"INPUT",{type:!0,placeholder:!0,class:!0}),f=D(V),h=m(V,"BUTTON",{class:!0,"data-svelte-h":!0}),q(h)!=="svelte-1gi1xxx"&&(h.textContent=u),V.forEach(d),M.forEach(d),g=D(H),k.l(H),H.forEach(d),this.h()},h(){document.title="Audit Log - OCM",p(i,"class","text-2xl font-bold text-gray-900"),p(a,"type","text"),p(a,"placeholder","Filter by service..."),p(a,"class","input w-48"),p(h,"class","btn btn-secondary"),p(n,"class","flex items-center gap-4"),p(t,"class","flex items-center justify-between"),p(s,"class","space-y-6")},m(_,w){E(_,e,w),E(_,s,w),o(s,t),o(t,i),o(t,l),o(t,n),o(n,a),K(a,r[3]),o(n,f),o(n,h),o(s,g),k.m(s,null),T||(L=[O(a,"input",r[5]),O(a,"keydown",r[6]),O(h,"click",r[4])],T=!0)},p(_,[w]){w&8&&a.value!==_[3]&&K(a,_[3]),S===(S=I(_))&&k?k.p(_,w):(k.d(1),k=S(_),k&&(k.c(),k.m(s,null)))},i:B,o:B,d(_){_&&(d(e),d(s)),k.d(),T=!1,ae(L)}}}function ee(r){return new Date(r).toLocaleString()}function te(r){return r.includes("approved")?"text-green-600 bg-green-50":r.includes("denied")||r.includes("revoked")?"text-red-600 bg-red-50":r.includes("request")?"text-orange-600 bg-orange-50":r.includes("access")?"text-blue-600 bg-blue-50":r.includes("created")?"text-purple-600 bg-purple-50":r.includes("deleted")?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50"}function se(r){return r.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function xe(r,e,s){let t=[],i=!0,c="",l="";ne(async()=>{await n()});async function n(){s(1,i=!0),s(2,c="");try{s(0,t=await ce.listAuditEntries(l||void 0))}catch(h){s(2,c=h instanceof Error?h.message:"Failed to load audit log")}finally{s(1,i=!1)}}function a(){l=this.value,s(3,l)}return[t,i,c,l,n,a,h=>h.key==="Enter"&&n()]}class ke extends oe{constructor(e){super(),de(this,e,xe,ve,le,{})}}export{ke as component};
