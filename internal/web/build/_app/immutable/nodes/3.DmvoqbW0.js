import{e as W,a as v,f as u,s as x}from"../chunks/BALovzVN.js";import{i as ve}from"../chunks/DVv75SxZ.js";import{F as ne,G as ue,n as pe,H as fe,I as xe,J as A,K as me,p as ge,o as ye,g as r,a as _e,e as be,c as s,s as n,b as h,$ as he,r as a,m as C,t as L,E as we}from"../chunks/vzSSS4xY.js";import{i as K}from"../chunks/CPMPC3H7.js";import{r as ke,e as Ae,i as Ee}from"../chunks/CW9yTeWy.js";import{h as Se,a as Fe}from"../chunks/DgVZwyRH.js";import{s as Ce}from"../chunks/CRF_Y0HF.js";function Le(e,c,m=c){var f=new WeakSet;ne(e,"input",async d=>{var i=d?e.defaultValue:e.value;if(i=N(e)?O(i):i,m(i),A!==null&&f.add(A),await ue(),i!==(i=c())){var g=e.selectionStart,y=e.selectionEnd,E=e.value.length;if(e.value=i??"",y!==null){var _=e.value.length;g===y&&y===E&&_>E?(e.selectionStart=_,e.selectionEnd=_):(e.selectionStart=g,e.selectionEnd=Math.min(y,_))}}}),(xe&&e.defaultValue!==e.value||pe(c)==null&&e.value)&&(m(N(e)?O(e.value):e.value),A!==null&&f.add(A)),fe(()=>{var d=c();if(e===document.activeElement){var i=me??A;if(f.has(i))return}N(e)&&d===O(e.value)||e.type==="date"&&!d&&!e.value||d!==e.value&&(e.value=d??"")})}function N(e){var c=e.type;return c==="number"||c==="range"}function O(e){return e===""?null:+e}var Me=u('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div></div>'),je=u('<div class="card p-4 bg-red-50 border-red-200"><p class="text-red-700"> </p></div>'),qe=u('<div class="card p-12 text-center"><div class="text-4xl mb-4">ðŸ“œ</div> <h3 class="text-lg font-medium text-gray-900">No audit entries</h3> <p class="mt-2 text-sm text-gray-500">Activity will appear here as it happens.</p></div>'),De=u('<span class="text-gray-500"> </span>'),Te=u('<span class="font-medium text-gray-900"> </span> <!>',1),Ve=u('<span class="text-gray-400">â€”</span>'),Ge=u('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm"><!></td><td class="px-6 py-4 text-sm text-gray-500 max-w-xs truncate"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td></tr>'),He=u('<div class="card overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Service / Scope</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actor</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Ie=u('<div class="space-y-6"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-gray-900">Audit Log</h1> <div class="flex items-center gap-4"><input type="text" placeholder="Filter by service..." class="input w-48"/> <button class="btn btn-secondary">Refresh</button></div></div> <!></div>');function ze(e,c){ge(c,!1);let m=C([]),f=C(!0),d=C(""),i=C("");ye(async()=>{await g()});async function g(){h(f,!0),h(d,"");try{h(m,await Fe.listAuditEntries(r(i)||void 0))}catch(t){h(d,t instanceof Error?t.message:"Failed to load audit log")}finally{h(f,!1)}}function y(t){return new Date(t).toLocaleString()}function E(t){return t.includes("approved")?"text-green-600 bg-green-50":t.includes("denied")||t.includes("revoked")?"text-red-600 bg-red-50":t.includes("request")?"text-orange-600 bg-orange-50":t.includes("access")?"text-blue-600 bg-blue-50":t.includes("created")?"text-purple-600 bg-purple-50":t.includes("deleted")?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50"}function _(t){return t.replace(/_/g," ").replace(/\b\w/g,l=>l.toUpperCase())}ve();var M=Ie();Se("1qyu7y8",t=>{be(()=>{he.title="Audit Log - OCM"})});var j=s(M),R=n(s(j),2),S=s(R);ke(S);var z=n(S,2);a(R),a(j);var B=n(j,2);{var P=t=>{var l=Me();v(t,l)},Q=t=>{var l=je(),w=s(l),F=s(w,!0);a(w),a(l),L(()=>x(F,r(d))),v(t,l)},X=t=>{var l=qe();v(t,l)},Y=t=>{var l=He(),w=s(l),F=n(s(w));Ae(F,5,()=>r(m),Ee,(Z,o)=>{var q=Ge(),D=s(q),$=s(D,!0);a(D);var T=n(D),V=s(T),ee=s(V,!0);a(V),a(T);var G=n(T),te=s(G);{var ae=p=>{var b=Te(),k=we(b),le=s(k,!0);a(k);var de=n(k,2);{var ce=I=>{var J=De(),oe=s(J);a(J),L(()=>x(oe,`:${r(o).scope??""}`)),v(I,J)};K(de,I=>{r(o).scope&&I(ce)})}L(()=>x(le,r(o).service)),v(p,b)},re=p=>{var b=Ve();v(p,b)};K(te,p=>{r(o).service?p(ae):p(re,!1)})}a(G);var H=n(G),se=s(H,!0);a(H);var U=n(H),ie=s(U,!0);a(U),a(q),L((p,b,k)=>{x($,p),Ce(V,1,`px-2 py-1 text-xs font-medium rounded ${b??""}`),x(ee,k),x(se,r(o).details||"â€”"),x(ie,r(o).actor)},[()=>y(r(o).timestamp),()=>E(r(o).action),()=>_(r(o).action)]),v(Z,q)}),a(F),a(w),a(l),v(t,l)};K(B,t=>{r(f)?t(P):r(d)?t(Q,1):r(m).length===0?t(X,2):t(Y,!1)})}a(M),Le(S,()=>r(i),t=>h(i,t)),W("keydown",S,t=>t.key==="Enter"&&g()),W("click",z,g),v(e,M),_e()}export{ze as component};
