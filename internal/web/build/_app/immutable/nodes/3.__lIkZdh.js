import{e as R,a as d,f as l,s as c}from"../chunks/KYN5GAs2.js";import{i as ot}from"../chunks/UI4lZKAz.js";import{p as lt,o as pt,g as a,a as ct,e as nt,c as r,s as o,b as v,$ as vt,r as e,m as y,t as _,f as xt}from"../chunks/gARCV1Ho.js";import{i as T}from"../chunks/CnseRUlR.js";import{r as ut,e as ft,i as mt}from"../chunks/CpCaBn83.js";import{h as gt,a as yt}from"../chunks/DA8qNB4W.js";import{s as _t}from"../chunks/DbE39UvF.js";import{b as bt}from"../chunks/BIwFEnwV.js";var ht=l('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div></div>'),wt=l('<div class="card p-4 bg-red-50 border-red-200"><p class="text-red-700"> </p></div>'),kt=l('<div class="card p-12 text-center"><div class="text-4xl mb-4">ðŸ“œ</div> <h3 class="text-lg font-medium text-gray-900">No audit entries</h3> <p class="mt-2 text-sm text-gray-500">Activity will appear here as it happens.</p></div>'),At=l('<span class="text-gray-500"> </span>'),Ct=l('<span class="font-medium text-gray-900"> </span> <!>',1),Et=l('<span class="text-gray-400">â€”</span>'),Ft=l('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm"><!></td><td class="px-6 py-4 text-sm text-gray-500 max-w-xs truncate"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td></tr>'),Lt=l('<div class="card overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Service / Scope</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actor</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),St=l('<div class="space-y-6"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-gray-900">Audit Log</h1> <div class="flex items-center gap-4"><input type="text" placeholder="Filter by service..." class="input w-48"/> <button class="btn btn-secondary">Refresh</button></div></div> <!></div>');function Ut(U,z){lt(z,!1);let b=y([]),h=y(!0),f=y(""),w=y("");pt(async()=>{await k()});async function k(){v(h,!0),v(f,"");try{v(b,await yt.listAuditEntries(a(w)||void 0))}catch(t){v(f,t instanceof Error?t.message:"Failed to load audit log")}finally{v(h,!1)}}function B(t){return new Date(t).toLocaleString()}function G(t){return t.includes("approved")?"text-green-600 bg-green-50":t.includes("denied")||t.includes("revoked")?"text-red-600 bg-red-50":t.includes("request")?"text-orange-600 bg-orange-50":t.includes("access")?"text-blue-600 bg-blue-50":t.includes("created")?"text-purple-600 bg-purple-50":t.includes("deleted")?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50"}function H(t){return t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())}ot();var A=St();gt("1qyu7y8",t=>{nt(()=>{vt.title="Audit Log - OCM"})});var C=r(A),N=o(r(C),2),m=r(N);ut(m);var I=o(m,2);e(N),e(C);var J=o(C,2);{var K=t=>{var s=ht();d(t,s)},P=t=>{var s=wt(),x=r(s),g=r(x,!0);e(x),e(s),_(()=>c(g,a(f))),d(t,s)},Q=t=>{var s=kt();d(t,s)},V=t=>{var s=Lt(),x=r(s),g=o(r(x));ft(g,5,()=>a(b),mt,(W,i)=>{var E=Ft(),F=r(E),X=r(F,!0);e(F);var L=o(F),S=r(L),Y=r(S,!0);e(S),e(L);var j=o(L),Z=r(j);{var $=p=>{var n=Ct(),u=xt(n),rt=r(u,!0);e(u);var st=o(u,2);{var it=D=>{var M=At(),dt=r(M);e(M),_(()=>c(dt,`:${a(i).scope??""}`)),d(D,M)};T(st,D=>{a(i).scope&&D(it)})}_(()=>c(rt,a(i).service)),d(p,n)},tt=p=>{var n=Et();d(p,n)};T(Z,p=>{a(i).service?p($):p(tt,!1)})}e(j);var q=o(j),et=r(q,!0);e(q);var O=o(q),at=r(O,!0);e(O),e(E),_((p,n,u)=>{c(X,p),_t(S,1,`px-2 py-1 text-xs font-medium rounded ${n??""}`),c(Y,u),c(et,a(i).details||"â€”"),c(at,a(i).actor)},[()=>B(a(i).timestamp),()=>G(a(i).action),()=>H(a(i).action)]),d(W,E)}),e(g),e(x),e(s),d(t,s)};T(J,t=>{a(h)?t(K):a(f)?t(P,1):a(b).length===0?t(Q,2):t(V,!1)})}e(A),bt(m,()=>a(w),t=>v(w,t)),R("keydown",m,t=>t.key==="Enter"&&k()),R("click",I,k),d(U,A),ct()}export{Ut as component};
