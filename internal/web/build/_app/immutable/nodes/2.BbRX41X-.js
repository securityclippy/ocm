import{s as p,a as x,f as u,e as X}from"../chunks/BALovzVN.js";import{i as I}from"../chunks/DVv75SxZ.js";import{p as J,s as d,c as r,r as a,g as e,n as f,t as k,E as K,a as N,o as Y,b as _,e as Z,$ as ee,m as G}from"../chunks/vzSSS4xY.js";import{i as R}from"../chunks/CPMPC3H7.js";import{h as te,a as H}from"../chunks/DgVZwyRH.js";import{P as ae}from"../chunks/D8JjkBOC.js";import{e as re,i as se}from"../chunks/CW9yTeWy.js";import{s as ie}from"../chunks/CRF_Y0HF.js";import{p as de}from"../chunks/BKbhBXlj.js";var ve=u('<span class="text-gray-500"> </span>'),oe=u('<span class="font-medium"> </span> <!>',1),ne=u('<span class="text-gray-500">System</span>'),le=u('<p class="text-xs text-gray-500 truncate"> </p>'),ce=u('<div class="px-6 py-4 flex items-center gap-4"><div class="flex-shrink-0"><span> </span></div> <div class="flex-1 min-w-0"><div class="text-sm text-gray-900"><!></div> <!></div> <div class="flex-shrink-0 text-xs text-gray-400"> </div> <div class="flex-shrink-0 text-xs text-gray-500"> </div></div>'),fe=u('<div class="card"><div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2> <a href="/audit" class="text-sm text-primary-600 hover:text-primary-700">View all</a></div> <div class="divide-y divide-gray-200"></div></div>');function pe(L,P){J(P,!1);let v=de(P,"entries",8);function w(o){return new Date(o).toLocaleString()}function b(o){return o.includes("approved")?"text-green-600 bg-green-50":o.includes("denied")||o.includes("revoked")?"text-red-600 bg-red-50":o.includes("request")?"text-orange-600 bg-orange-50":o.includes("access")?"text-blue-600 bg-blue-50":"text-gray-600 bg-gray-50"}function F(o){return o.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}I();var h=fe(),A=d(r(h),2);re(A,5,v,se,(o,t)=>{var q=ce(),C=r(q),D=r(C),s=r(D,!0);a(D),a(C);var n=d(C,2),c=r(n),y=r(c);{var M=i=>{var l=oe(),m=K(l),V=r(m,!0);a(m);var g=d(m,2);{var Q=z=>{var B=ve(),W=r(B);a(B),k(()=>p(W,`:${e(t),f(()=>e(t).scope)??""}`)),x(z,B)};R(g,z=>{e(t),f(()=>e(t).scope)&&z(Q)})}k(()=>p(V,(e(t),f(()=>e(t).service)))),x(i,l)},O=i=>{var l=ne();x(i,l)};R(y,i=>{e(t),f(()=>e(t).service)?i(M):i(O,!1)})}a(c);var E=d(c,2);{var S=i=>{var l=le(),m=r(l,!0);a(l),k(()=>p(m,(e(t),f(()=>e(t).details)))),x(i,l)};R(E,i=>{e(t),f(()=>e(t).details)&&i(S)})}a(n);var $=d(n,2),T=r($,!0);a($);var j=d($,2),U=r(j,!0);a(j),a(q),k((i,l,m)=>{ie(D,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i??""}`),p(s,l),p(T,m),p(U,(e(t),f(()=>e(t).actor)))},[()=>(e(t),f(()=>b(e(t).action))),()=>(e(t),f(()=>F(e(t).action))),()=>(e(t),f(()=>w(e(t).timestamp)))]),x(o,q)}),a(A),a(h),x(L,h),N()}var xe=u('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div></div>'),ue=u('<div class="card p-4 bg-red-50 border-red-200"><p class="text-red-700"> </p></div>'),me=u('<div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="card p-6"><div class="text-sm font-medium text-gray-500">Total Credentials</div> <div class="mt-2 text-3xl font-bold text-gray-900"> </div></div> <div class="card p-6"><div class="text-sm font-medium text-gray-500">Pending Requests</div> <div class="mt-2 text-3xl font-bold text-orange-600"> </div></div> <div class="card p-6"><div class="text-sm font-medium text-gray-500">Active Elevations</div> <div class="mt-2 text-3xl font-bold text-green-600"> </div></div></div> <!> <!>',1),ge=u('<div class="space-y-6"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-gray-900">Dashboard</h1> <button class="btn btn-secondary">Refresh</button></div> <!></div>');function Ce(L,P){J(P,!1);let v=G(null),w=G(!0),b=G("");Y(async()=>{try{_(v,await H.getDashboard())}catch(s){_(b,s instanceof Error?s.message:"Failed to load dashboard")}finally{_(w,!1)}});function F(){_(w,!0),_(b,""),H.getDashboard().then(s=>_(v,s)).catch(s=>_(b,s instanceof Error?s.message:"Failed to load")).finally(()=>_(w,!1))}I();var h=ge();te("1uha8ag",s=>{Z(()=>{ee.title="Dashboard - OCM"})});var A=r(h),o=d(r(A),2);a(A);var t=d(A,2);{var q=s=>{var n=xe();x(s,n)},C=s=>{var n=ue(),c=r(n),y=r(c,!0);a(c),a(n),k(()=>p(y,e(b))),x(s,n)},D=s=>{var n=me(),c=K(n),y=r(c),M=d(r(y),2),O=r(M,!0);a(M),a(y);var E=d(y,2),S=d(r(E),2),$=r(S,!0);a(S),a(E);var T=d(E,2),j=d(r(T),2),U=r(j,!0);a(j),a(T),a(c);var i=d(c,2);{var l=g=>{ae(g,{get requests(){return e(v).pending},$$events:{action:F}})};R(i,g=>{e(v).pending&&e(v).pending.length>0&&g(l)})}var m=d(i,2);{var V=g=>{pe(g,{get entries(){return e(v).recentAudit}})};R(m,g=>{e(v).recentAudit&&e(v).recentAudit.length>0&&g(V)})}k(()=>{p(O,e(v).totalCredentials),p($,e(v).pendingRequests),p(U,e(v).activeElevations)}),x(s,n)};R(t,s=>{e(w)?s(q):e(b)?s(C,1):e(v)&&s(D,2)})}a(h),X("click",o,F),x(L,h),N()}export{Ce as component};
