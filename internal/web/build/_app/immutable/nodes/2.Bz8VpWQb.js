import{s as _e,n as J,d,v as ke,i as w,b as f,o as _,c as p,e as E,q as K,g as $,h as m,j as q,a as O,f as L,t as z,w as Y,m as Ee,p as De,u as Ce}from"../chunks/CRWUcP0W.js";import{S as pe,i as me,t as G,a as F,c as Z,g as ee,d as ge,m as be,b as xe,e as ye}from"../chunks/BcwE73Mx.js";import{e as ne,a as ie}from"../chunks/D3Pj8aXw.js";import{P as Ve}from"../chunks/BzgcPs6U.js";function re(i,e,s){const t=i.slice();return t[1]=e[s],t}function Ie(i){let e,s="System";return{c(){e=m("span"),e.textContent=s,this.h()},l(t){e=p(t,"SPAN",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1bevb7z"&&(e.textContent=s),this.h()},h(){_(e,"class","text-gray-500")},m(t,l){w(t,e,l)},p:J,d(t){t&&d(e)}}}function Ae(i){let e,s=i[1].service+"",t,l,r,a=i[1].scope&&ae(i);return{c(){e=m("span"),t=z(s),l=q(),a&&a.c(),r=Y(),this.h()},l(n){e=p(n,"SPAN",{class:!0});var c=E(e);t=L(c,s),c.forEach(d),l=$(n),a&&a.l(n),r=Y(),this.h()},h(){_(e,"class","font-medium")},m(n,c){w(n,e,c),f(e,t),w(n,l,c),a&&a.m(n,c),w(n,r,c)},p(n,c){c&1&&s!==(s=n[1].service+"")&&O(t,s),n[1].scope?a?a.p(n,c):(a=ae(n),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null)},d(n){n&&(d(e),d(l),d(r)),a&&a.d(n)}}}function ae(i){let e,s,t=i[1].scope+"",l;return{c(){e=m("span"),s=z(":"),l=z(t),this.h()},l(r){e=p(r,"SPAN",{class:!0});var a=E(e);s=L(a,":"),l=L(a,t),a.forEach(d),this.h()},h(){_(e,"class","text-gray-500")},m(r,a){w(r,e,a),f(e,s),f(e,l)},p(r,a){a&1&&t!==(t=r[1].scope+"")&&O(l,t)},d(r){r&&d(e)}}}function oe(i){let e,s=i[1].details+"",t;return{c(){e=m("p"),t=z(s),this.h()},l(l){e=p(l,"P",{class:!0});var r=E(e);t=L(r,s),r.forEach(d),this.h()},h(){_(e,"class","text-xs text-gray-500 truncate")},m(l,r){w(l,e,r),f(e,t)},p(l,r){r&1&&s!==(s=l[1].details+"")&&O(t,s)},d(l){l&&d(e)}}}function ce(i){let e,s,t,l=ue(i[1].action)+"",r,a,n,c,g,o,u,P,T=fe(i[1].timestamp)+"",N,M,V,j=i[1].actor+"",h,I;function S(x,b){return x[1].service?Ae:Ie}let R=S(i),A=R(i),D=i[1].details&&oe(i);return{c(){e=m("div"),s=m("div"),t=m("span"),r=z(l),n=q(),c=m("div"),g=m("div"),A.c(),o=q(),D&&D.c(),u=q(),P=m("div"),N=z(T),M=q(),V=m("div"),h=z(j),I=q(),this.h()},l(x){e=p(x,"DIV",{class:!0});var b=E(e);s=p(b,"DIV",{class:!0});var U=E(s);t=p(U,"SPAN",{class:!0});var B=E(t);r=L(B,l),B.forEach(d),U.forEach(d),n=$(b),c=p(b,"DIV",{class:!0});var H=E(c);g=p(H,"DIV",{class:!0});var y=E(g);A.l(y),y.forEach(d),o=$(H),D&&D.l(H),H.forEach(d),u=$(b),P=p(b,"DIV",{class:!0});var k=E(P);N=L(k,T),k.forEach(d),M=$(b),V=p(b,"DIV",{class:!0});var v=E(V);h=L(v,j),v.forEach(d),I=$(b),b.forEach(d),this.h()},h(){_(t,"class",a="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+de(i[1].action)),_(s,"class","flex-shrink-0"),_(g,"class","text-sm text-gray-900"),_(c,"class","flex-1 min-w-0"),_(P,"class","flex-shrink-0 text-xs text-gray-400"),_(V,"class","flex-shrink-0 text-xs text-gray-500"),_(e,"class","px-6 py-4 flex items-center gap-4")},m(x,b){w(x,e,b),f(e,s),f(s,t),f(t,r),f(e,n),f(e,c),f(c,g),A.m(g,null),f(c,o),D&&D.m(c,null),f(e,u),f(e,P),f(P,N),f(e,M),f(e,V),f(V,h),f(e,I)},p(x,b){b&1&&l!==(l=ue(x[1].action)+"")&&O(r,l),b&1&&a!==(a="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+de(x[1].action))&&_(t,"class",a),R===(R=S(x))&&A?A.p(x,b):(A.d(1),A=R(x),A&&(A.c(),A.m(g,null))),x[1].details?D?D.p(x,b):(D=oe(x),D.c(),D.m(c,null)):D&&(D.d(1),D=null),b&1&&T!==(T=fe(x[1].timestamp)+"")&&O(N,T),b&1&&j!==(j=x[1].actor+"")&&O(h,j)},d(x){x&&d(e),A.d(),D&&D.d()}}}function $e(i){let e,s,t='<h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2> <a href="/audit" class="text-sm text-primary-600 hover:text-primary-700">View all</a>',l,r,a=ne(i[0]),n=[];for(let c=0;c<a.length;c+=1)n[c]=ce(re(i,a,c));return{c(){e=m("div"),s=m("div"),s.innerHTML=t,l=q(),r=m("div");for(let c=0;c<n.length;c+=1)n[c].c();this.h()},l(c){e=p(c,"DIV",{class:!0});var g=E(e);s=p(g,"DIV",{class:!0,"data-svelte-h":!0}),K(s)!=="svelte-5k2ruz"&&(s.innerHTML=t),l=$(g),r=p(g,"DIV",{class:!0});var o=E(r);for(let u=0;u<n.length;u+=1)n[u].l(o);o.forEach(d),g.forEach(d),this.h()},h(){_(s,"class","px-6 py-4 border-b border-gray-200 flex items-center justify-between"),_(r,"class","divide-y divide-gray-200"),_(e,"class","card")},m(c,g){w(c,e,g),f(e,s),f(e,l),f(e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(r,null)},p(c,[g]){if(g&1){a=ne(c[0]);let o;for(o=0;o<a.length;o+=1){const u=re(c,a,o);n[o]?n[o].p(u,g):(n[o]=ce(u),n[o].c(),n[o].m(r,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=a.length}},i:J,o:J,d(c){c&&d(e),ke(n,c)}}}function fe(i){return new Date(i).toLocaleString()}function de(i){return i.includes("approved")?"text-green-600 bg-green-50":i.includes("denied")||i.includes("revoked")?"text-red-600 bg-red-50":i.includes("request")?"text-orange-600 bg-orange-50":i.includes("access")?"text-blue-600 bg-blue-50":"text-gray-600 bg-gray-50"}function ue(i){return i.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function qe(i,e,s){let{entries:t}=e;return i.$$set=l=>{"entries"in l&&s(0,t=l.entries)},[t]}class we extends pe{constructor(e){super(),me(this,e,qe,$e,_e,{entries:0})}}function Pe(i){let e,s,t,l="Total Credentials",r,a,n=i[0].totalCredentials+"",c,g,o,u,P="Pending Requests",T,N,M=i[0].pendingRequests+"",V,j,h,I,S="Active Elevations",R,A,D=i[0].activeElevations+"",x,b,U,B,H,y=i[0].pending&&i[0].pending.length>0&&ve(i),k=i[0].recentAudit&&i[0].recentAudit.length>0&&he(i);return{c(){e=m("div"),s=m("div"),t=m("div"),t.textContent=l,r=q(),a=m("div"),c=z(n),g=q(),o=m("div"),u=m("div"),u.textContent=P,T=q(),N=m("div"),V=z(M),j=q(),h=m("div"),I=m("div"),I.textContent=S,R=q(),A=m("div"),x=z(D),b=q(),y&&y.c(),U=q(),k&&k.c(),B=Y(),this.h()},l(v){e=p(v,"DIV",{class:!0});var C=E(e);s=p(C,"DIV",{class:!0});var Q=E(s);t=p(Q,"DIV",{class:!0,"data-svelte-h":!0}),K(t)!=="svelte-5uu22x"&&(t.textContent=l),r=$(Q),a=p(Q,"DIV",{class:!0});var te=E(a);c=L(te,n),te.forEach(d),Q.forEach(d),g=$(C),o=p(C,"DIV",{class:!0});var W=E(o);u=p(W,"DIV",{class:!0,"data-svelte-h":!0}),K(u)!=="svelte-gk34xy"&&(u.textContent=P),T=$(W),N=p(W,"DIV",{class:!0});var se=E(N);V=L(se,M),se.forEach(d),W.forEach(d),j=$(C),h=p(C,"DIV",{class:!0});var X=E(h);I=p(X,"DIV",{class:!0,"data-svelte-h":!0}),K(I)!=="svelte-17s3hkv"&&(I.textContent=S),R=$(X),A=p(X,"DIV",{class:!0});var le=E(A);x=L(le,D),le.forEach(d),X.forEach(d),C.forEach(d),b=$(v),y&&y.l(v),U=$(v),k&&k.l(v),B=Y(),this.h()},h(){_(t,"class","text-sm font-medium text-gray-500"),_(a,"class","mt-2 text-3xl font-bold text-gray-900"),_(s,"class","card p-6"),_(u,"class","text-sm font-medium text-gray-500"),_(N,"class","mt-2 text-3xl font-bold text-orange-600"),_(o,"class","card p-6"),_(I,"class","text-sm font-medium text-gray-500"),_(A,"class","mt-2 text-3xl font-bold text-green-600"),_(h,"class","card p-6"),_(e,"class","grid grid-cols-1 md:grid-cols-3 gap-6")},m(v,C){w(v,e,C),f(e,s),f(s,t),f(s,r),f(s,a),f(a,c),f(e,g),f(e,o),f(o,u),f(o,T),f(o,N),f(N,V),f(e,j),f(e,h),f(h,I),f(h,R),f(h,A),f(A,x),w(v,b,C),y&&y.m(v,C),w(v,U,C),k&&k.m(v,C),w(v,B,C),H=!0},p(v,C){(!H||C&1)&&n!==(n=v[0].totalCredentials+"")&&O(c,n),(!H||C&1)&&M!==(M=v[0].pendingRequests+"")&&O(V,M),(!H||C&1)&&D!==(D=v[0].activeElevations+"")&&O(x,D),v[0].pending&&v[0].pending.length>0?y?(y.p(v,C),C&1&&F(y,1)):(y=ve(v),y.c(),F(y,1),y.m(U.parentNode,U)):y&&(ee(),G(y,1,1,()=>{y=null}),Z()),v[0].recentAudit&&v[0].recentAudit.length>0?k?(k.p(v,C),C&1&&F(k,1)):(k=he(v),k.c(),F(k,1),k.m(B.parentNode,B)):k&&(ee(),G(k,1,1,()=>{k=null}),Z())},i(v){H||(F(y),F(k),H=!0)},o(v){G(y),G(k),H=!1},d(v){v&&(d(e),d(b),d(U),d(B)),y&&y.d(v),k&&k.d(v)}}}function Ne(i){let e,s,t;return{c(){e=m("div"),s=m("p"),t=z(i[2]),this.h()},l(l){e=p(l,"DIV",{class:!0});var r=E(e);s=p(r,"P",{class:!0});var a=E(s);t=L(a,i[2]),a.forEach(d),r.forEach(d),this.h()},h(){_(s,"class","text-red-700"),_(e,"class","card p-4 bg-red-50 border-red-200")},m(l,r){w(l,e,r),f(e,s),f(s,t)},p(l,r){r&4&&O(t,l[2])},i:J,o:J,d(l){l&&d(e)}}}function Se(i){let e,s='<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div>';return{c(){e=m("div"),e.innerHTML=s,this.h()},l(t){e=p(t,"DIV",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-18msshe"&&(e.innerHTML=s),this.h()},h(){_(e,"class","flex items-center justify-center py-12")},m(t,l){w(t,e,l)},p:J,i:J,o:J,d(t){t&&d(e)}}}function ve(i){let e,s;return e=new Ve({props:{requests:i[0].pending}}),e.$on("action",i[3]),{c(){ye(e.$$.fragment)},l(t){xe(e.$$.fragment,t)},m(t,l){be(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.requests=t[0].pending),e.$set(r)},i(t){s||(F(e.$$.fragment,t),s=!0)},o(t){G(e.$$.fragment,t),s=!1},d(t){ge(e,t)}}}function he(i){let e,s;return e=new we({props:{entries:i[0].recentAudit}}),{c(){ye(e.$$.fragment)},l(t){xe(e.$$.fragment,t)},m(t,l){be(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.entries=t[0].recentAudit),e.$set(r)},i(t){s||(F(e.$$.fragment,t),s=!0)},o(t){G(e.$$.fragment,t),s=!1},d(t){ge(e,t)}}}function Te(i){let e,s,t,l,r="Dashboard",a,n,c="Refresh",g,o,u,P,T,N;const M=[Se,Ne,Pe],V=[];function j(h,I){return h[1]?0:h[2]?1:h[0]?2:-1}return~(o=j(i))&&(u=V[o]=M[o](i)),{c(){e=q(),s=m("div"),t=m("div"),l=m("h1"),l.textContent=r,a=q(),n=m("button"),n.textContent=c,g=q(),u&&u.c(),this.h()},l(h){De("svelte-1de09pu",document.head).forEach(d),e=$(h),s=p(h,"DIV",{class:!0});var S=E(s);t=p(S,"DIV",{class:!0});var R=E(t);l=p(R,"H1",{class:!0,"data-svelte-h":!0}),K(l)!=="svelte-1q7i6n"&&(l.textContent=r),a=$(R),n=p(R,"BUTTON",{class:!0,"data-svelte-h":!0}),K(n)!=="svelte-1j25hzp"&&(n.textContent=c),R.forEach(d),g=$(S),u&&u.l(S),S.forEach(d),this.h()},h(){document.title="Dashboard - OCM",_(l,"class","text-2xl font-bold text-gray-900"),_(n,"class","btn btn-secondary"),_(t,"class","flex items-center justify-between"),_(s,"class","space-y-6")},m(h,I){w(h,e,I),w(h,s,I),f(s,t),f(t,l),f(t,a),f(t,n),f(s,g),~o&&V[o].m(s,null),P=!0,T||(N=Ee(n,"click",i[3]),T=!0)},p(h,[I]){let S=o;o=j(h),o===S?~o&&V[o].p(h,I):(u&&(ee(),G(V[S],1,1,()=>{V[S]=null}),Z()),~o?(u=V[o],u?u.p(h,I):(u=V[o]=M[o](h),u.c()),F(u,1),u.m(s,null)):u=null)},i(h){P||(F(u),P=!0)},o(h){G(u),P=!1},d(h){h&&(d(e),d(s)),~o&&V[o].d(),T=!1,N()}}}function Re(i,e,s){let t=null,l=!0,r="";Ce(async()=>{try{s(0,t=await ie.getDashboard())}catch(n){s(2,r=n instanceof Error?n.message:"Failed to load dashboard")}finally{s(1,l=!1)}});function a(){s(1,l=!0),s(2,r=""),ie.getDashboard().then(n=>s(0,t=n)).catch(n=>s(2,r=n instanceof Error?n.message:"Failed to load")).finally(()=>s(1,l=!1))}return[t,l,r,a]}class ze extends pe{constructor(e){super(),me(this,e,Re,Te,_e,{})}}export{ze as component};
