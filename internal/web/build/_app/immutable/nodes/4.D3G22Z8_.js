import{e as b,a as c,f as m,s as y,t as at}from"../chunks/KYN5GAs2.js";import{i as rt}from"../chunks/UI4lZKAz.js";import{p as st,o as it,f as ot,a as lt,e as dt,s as a,b as v,$ as nt,c as r,r as t,g as e,m as w,t as G,n as Ve,i as E,d as K,u as vt,h as pt}from"../chunks/gARCV1Ho.js";import{i as R}from"../chunks/CnseRUlR.js";import{e as fe,i as ge,s as ct,r as k}from"../chunks/CpCaBn83.js";import{h as ut,a as he}from"../chunks/DA8qNB4W.js";import{s as mt}from"../chunks/DbE39UvF.js";import{b as U,a as Ie}from"../chunks/BIwFEnwV.js";import{b as Oe}from"../chunks/DO8PN5ND.js";var xt=m('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div></div>'),bt=m('<div class="card p-4 bg-red-50 border-red-200"><p class="text-red-700"> </p></div>'),yt=m('<div class="card p-12 text-center"><div class="text-4xl mb-4">ðŸ”‘</div> <h3 class="text-lg font-medium text-gray-900">No credentials yet</h3> <p class="mt-2 text-sm text-gray-500">Add your first credential to get started.</p> <button class="btn btn-primary mt-4">Add Credential</button></div>'),_t=m("<span> <!></span>"),ft=m('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900"> </div> <div class="text-xs text-gray-500"> </div></td><td class="px-6 py-4 whitespace-nowrap"><span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded"> </span></td><td class="px-6 py-4"><div class="flex flex-wrap gap-1"></div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><a class="text-primary-600 hover:text-primary-900 mr-4">Edit</a> <button class="text-red-600 hover:text-red-900">Delete</button></td></tr>'),gt=m('<div class="card overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Service</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Scopes</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Updated</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),ht=m('<div class="p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm"> </div>'),wt=m('<button type="button" class="text-red-500 hover:text-red-700 text-sm">Remove</button>'),kt=m('<div class="p-4 bg-gray-50 rounded-lg space-y-3"><div class="flex items-center justify-between"><span class="text-sm font-medium text-gray-600"></span> <!></div> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-gray-500 mb-1">Scope Name</label> <input type="text" placeholder="read, write, send, etc." class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"/></div> <div><label class="block text-xs text-gray-500 mb-1">Environment Variable</label> <input type="text" placeholder="GMAIL_TOKEN" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"/></div></div> <div><label class="block text-xs text-gray-500 mb-1">Token/Secret</label> <input type="password" placeholder="Enter token or secret..." class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"/></div> <div class="grid grid-cols-3 gap-3"><div><label class="block text-xs text-gray-500 mb-1">Max TTL</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"><option>15 minutes</option><option>30 minutes</option><option>1 hour</option><option>2 hours</option><option>4 hours</option><option>8 hours</option><option>24 hours</option></select></div> <div class="flex items-center pt-5"><label class="flex items-center gap-2 text-sm"><input type="checkbox" class="rounded"/> Requires Approval</label></div> <div class="flex items-center pt-5"><label class="flex items-center gap-2 text-sm"><input type="checkbox" class="rounded"/> Permanent Access</label></div></div></div>'),Tt=m('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"><div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Add Credential</h2> <button class="text-gray-400 hover:text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-4"><!> <div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Service ID</label> <input type="text" placeholder="gmail, github, etc." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Display Name</label> <input type="text" placeholder="Gmail API, GitHub, etc." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"/></div></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Type</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"><option>OAuth2</option><option>API Key</option><option>Token</option><option>Username/Password</option></select></div> <div><div class="flex items-center justify-between mb-2"><label class="block text-sm font-medium text-gray-700">Scopes</label> <button type="button" class="text-sm text-primary-600 hover:text-primary-700">+ Add Scope</button></div> <div class="space-y-3"></div></div></div> <div class="px-6 py-4 border-t border-gray-200 flex justify-end gap-3"><button class="btn btn-secondary">Cancel</button> <button class="btn btn-primary"> </button></div></div></div>'),At=m('<div class="space-y-6"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-gray-900">Credentials</h1> <button class="btn btn-primary">Add Credential</button></div> <!></div> <!>',1);function Vt($e,Fe){st(Fe,!1);let Z=w([]),ee=w(!0),z=w(""),B=w(!1),H=w(!1),T=w(""),i=w({service:"",displayName:"",type:"oauth2",scopes:[{name:"default",envVar:"",token:"",requiresApproval:!0,permanent:!1,maxTTL:"1h"}]});it(async()=>{await te()});async function te(){v(ee,!0),v(z,"");try{v(Z,await he.listCredentials())}catch(o){v(z,o instanceof Error?o.message:"Failed to load credentials")}finally{v(ee,!1)}}async function Pe(o){if(confirm(`Delete credential "${o}"? This cannot be undone.`))try{await he.deleteCredential(o),await te()}catch(s){alert(s instanceof Error?s.message:"Failed to delete")}}function Ge(o){return new Date(o).toLocaleDateString()}function Ke(){v(i,{service:"",displayName:"",type:"oauth2",scopes:[{name:"default",envVar:"",token:"",requiresApproval:!0,permanent:!1,maxTTL:"1h"}]}),v(T,"")}function ae(){v(B,!1),Ke()}function Re(){K(i,e(i).scopes=[...e(i).scopes,{name:"",envVar:"",token:"",requiresApproval:!0,permanent:!1,maxTTL:"1h"}])}function Ue(o){K(i,e(i).scopes=e(i).scopes.filter((s,p)=>p!==o))}async function ze(){if(!e(i).service||!e(i).displayName){v(T,"Service ID and Display Name are required");return}const o={};for(const s of e(i).scopes)s.name&&(o[s.name]={envVar:s.envVar,token:s.token,requiresApproval:s.requiresApproval,permanent:s.permanent,maxTTL:s.maxTTL});v(H,!0),v(T,"");try{await he.createCredential({service:e(i).service,displayName:e(i).displayName,type:e(i).type,scopes:o}),ae(),await te()}catch(s){v(T,s instanceof Error?s.message:"Failed to save credential")}finally{v(H,!1)}}rt();var we=At();ut("bcpq9l",o=>{dt(()=>{nt.title="Credentials - OCM"})});var re=ot(we),se=r(re),Be=a(r(se),2);t(se);var He=a(se,2);{var Je=o=>{var s=xt();c(o,s)},Qe=o=>{var s=bt(),p=r(s),x=r(p,!0);t(p),t(s),G(()=>y(x,e(z))),c(o,s)},We=o=>{var s=yt(),p=a(r(s),6);t(s),b("click",p,()=>v(B,!0)),c(o,s)},Xe=o=>{var s=gt(),p=r(s),x=a(r(p));fe(x,5,()=>e(Z),ge,(ie,u)=>{var A=ft(),M=r(A),_=r(M),V=r(_,!0);t(_);var I=a(_,2),J=r(I,!0);t(I),t(M);var C=a(M),S=r(C),O=r(S,!0);t(S),t(C);var f=a(C),N=r(f);fe(N,5,()=>Object.entries(e(u).scopes),ge,(j,W)=>{var F=vt(()=>pt(e(W),2));let q=()=>e(F)[0],X=()=>e(F)[1];var d=_t(),l=r(d),D=a(l);{var P=h=>{var Y=at("(approval)");c(h,Y)};R(D,h=>{X().permanent||h(P)})}t(d),G(()=>{mt(d,1,`px-2 py-0.5 text-xs rounded ${X().permanent?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`),y(l,`${q()??""} `)}),c(j,d)}),t(N),t(f);var g=a(f),Q=r(g,!0);t(g);var $=a(g),L=r($),oe=a(L,2);t($),t(A),G(j=>{y(V,e(u).displayName),y(J,e(u).service),y(O,e(u).type),y(Q,j),ct(L,"href",`/credentials/${e(u).service??""}`)},[()=>Ge(e(u).updatedAt)]),b("click",oe,()=>Pe(e(u).service)),c(ie,A)}),t(x),t(p),t(s),c(o,s)};R(He,o=>{e(ee)?o(Je):e(z)?o(Qe,1):e(Z).length===0?o(We,2):o(Xe,!1)})}t(re);var Ye=a(re,2);{var Ze=o=>{var s=Tt(),p=r(s),x=r(p),ie=a(r(x),2);t(x);var u=a(x,2),A=r(u);{var M=d=>{var l=ht(),D=r(l,!0);t(l),G(()=>y(D,e(T))),c(d,l)};R(A,d=>{e(T)&&d(M)})}var _=a(A,2),V=r(_),I=a(r(V),2);k(I),t(V);var J=a(V,2),C=a(r(J),2);k(C),t(J),t(_);var S=a(_,2),O=a(r(S),2),f=r(O);f.value=f.__value="oauth2";var N=a(f);N.value=N.__value="api_key";var g=a(N);g.value=g.__value="token";var Q=a(g);Q.value=Q.__value="password",t(O),t(S);var $=a(S,2),L=r($),oe=a(r(L),2);t(L);var j=a(L,2);fe(j,5,()=>e(i).scopes,ge,(d,l,D)=>{var P=kt(),h=r(P),Y=r(h);Y.textContent=`Scope ${D+1}`;var et=a(Y,2);{var tt=n=>{var Me=wt();b("click",Me,()=>Ue(D)),c(n,Me)};R(et,n=>{e(i).scopes.length>1&&n(tt)})}t(h);var le=a(h,2),de=r(le),ke=a(r(de),2);k(ke),t(de);var Te=a(de,2),Ae=a(r(Te),2);k(Ae),t(Te),t(le);var ne=a(le,2),Ce=a(r(ne),2);k(Ce),t(ne);var Se=a(ne,2),ve=r(Se),pe=a(r(ve),2),ce=r(pe);ce.value=ce.__value="15m";var ue=a(ce);ue.value=ue.__value="30m";var me=a(ue);me.value=me.__value="1h";var xe=a(me);xe.value=xe.__value="2h";var be=a(xe);be.value=be.__value="4h";var ye=a(be);ye.value=ye.__value="8h";var Ne=a(ye);Ne.value=Ne.__value="24h",t(pe),t(ve);var _e=a(ve,2),Le=r(_e),je=r(Le);k(je),Ve(),t(Le),t(_e);var qe=a(_e,2),De=r(qe),Ee=r(De);k(Ee),Ve(),t(De),t(qe),t(Se),t(P),U(ke,()=>e(l).name,n=>(e(l).name=n,E(()=>e(i)))),U(Ae,()=>e(l).envVar,n=>(e(l).envVar=n,E(()=>e(i)))),U(Ce,()=>e(l).token,n=>(e(l).token=n,E(()=>e(i)))),Oe(pe,()=>e(l).maxTTL,n=>(e(l).maxTTL=n,E(()=>e(i)))),Ie(je,()=>e(l).requiresApproval,n=>(e(l).requiresApproval=n,E(()=>e(i)))),Ie(Ee,()=>e(l).permanent,n=>(e(l).permanent=n,E(()=>e(i)))),c(d,P)}),t(j),t($),t(u);var W=a(u,2),F=r(W),q=a(F,2),X=r(q,!0);t(q),t(W),t(p),t(s),G(()=>{q.disabled=e(H),y(X,e(H)?"Saving...":"Save Credential")}),b("click",ie,ae),U(I,()=>e(i).service,d=>K(i,e(i).service=d)),U(C,()=>e(i).displayName,d=>K(i,e(i).displayName=d)),Oe(O,()=>e(i).type,d=>K(i,e(i).type=d)),b("click",oe,Re),b("click",F,ae),b("click",q,ze),c(o,s)};R(Ye,o=>{e(B)&&o(Ze)})}b("click",Be,()=>v(B,!0)),c($e,we),lt()}export{Vt as component};
